<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quran - Faisal Kauser</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #4dae74 0%, #ffffff 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            padding: 30px;
            text-align: center;
            color: white;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .file-input-section {
            padding: 30px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        .file-input-wrapper {
            position: relative;
            display: inline-block;
        }

        .file-input {
            position: absolute;
            opacity: 0;
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .file-input-label {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            border-radius: 50px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 500;
            transition: all 0.3s ease;
            display: inline-block;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .file-input-label:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0;
            min-height: 600px;
        }

        .player-section {
            padding: 40px;
            background: linear-gradient(135deg, #80C4B7 0%, #fbfbfb 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .now-playing {
            text-align: center;
            margin-bottom: 40px;
            width: 100%;
        }

        .track-info h2 {
            font-size: 1.8rem;
            margin-bottom: 10px;
            color: #333;
            font-weight: 400;
        }

        .track-info p {
            font-size: 1.1rem;
            color: #666;
            margin-bottom: 5px;
        }

        .progress-container {
            width: 100%;
            margin: 30px 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            cursor: pointer;
            position: relative;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            width: 0%;
            transition: width 0.1s ease;
            position: relative;
        }

        .progress-fill::after {
            content: '';
            position: absolute;
            right: -6px;
            top: 50%;
            transform: translateY(-50%);
            width: 12px;
            height: 12px;
            background: white;
            border-radius: 50%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
        }

        .time-display {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #666;
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 20px;
            margin: 30px 0;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.9);
            border: none;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            cursor: pointer;
            font-size: 1.5rem;
            color: #333;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
        }

        .play-btn {
            width: 80px;
            height: 80px;
            font-size: 2rem;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .volume-container {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 20px;
        }

        .volume-slider {
            width: 120px;
            height: 6px;
            border-radius: 3px;
            background: rgba(255, 255, 255, 0.3);
            outline: none;
            cursor: pointer;
        }

        .playlist-section {
            padding: 40px;
            background: white;
            overflow-y: auto;
            max-height: 600px;
        }

        .playlist-header {
            font-size: 1.5rem;
            margin-bottom: 30px;
            color: #333;
            font-weight: 400;
        }

        .track-list {
            list-style: none;
        }

        .track-item {
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid transparent;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .track-item:hover {
            background: linear-gradient(135deg, #f8f9ff, #e8f2ff);
            border-color: #667eea;
        }

        .track-item.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            transform: translateX(5px);
        }

        .track-number {
            width: 30px;
            height: 30px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
            font-weight: 500;
        }

        .track-item.active .track-number {
            background: rgba(255, 255, 255, 0.2);
            color: white;
        }

        .track-details {
            flex: 1;
        }

        .track-name {
            font-weight: 500;
            margin-bottom: 3px;
        }

        .track-duration {
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .empty-state i {
            font-size: 4rem;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .loading-state {
            display: none;
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            background: #fee;
            color: #c33;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            border: 1px solid #fcc;
            display: none;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .player-section {
                order: 2;
            }
            
            .playlist-section {
                order: 1;
                max-height: 400px;
            }
            
            .controls {
                gap: 15px;
            }
            
            .control-btn {
                width: 50px;
                height: 50px;
                font-size: 1.2rem;
            }
            
            .play-btn {
                width: 70px;
                height: 70px;
                font-size: 1.8rem;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }

        @media (max-width: 480px) {
            .player-section, .playlist-section {
                padding: 20px;
            }
            
            .header {
                padding: 20px;
            }
            
            .file-input-section {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-kaaba"></i> القرآن الكريم</h1>
            <p>یہ قرآنِ پاک کی تلاوت مرحوم 'تسنيم کوثر' کے ایصالِ ثواب کے لیے ہے۔ </p>
			<p>اللہ تعالیٰ ان کی مغفرت فرمائے اور جنت الفردوس میں اعلیٰ مقام عطا فرمائے</p>
        </div>

        <div class="file-input-section" style="display: none;">
            <div class="file-input-wrapper">
                <input type="file" id="SurahFiles" class="file-input" multiple accept="audio/*" webkitdirectory directory>
                <label for="SurahFiles" class="file-input-label">
                    <i class="fas fa-folder-music"></i> Select Audio Folder
                </label>
            </div>
            <p style="margin-top: 15px; color: #666;">Choose your Audio folder to load all audio files</p>
        </div>

        <div class="error-message" id="errorMessage"></div>
        
        <div class="loading-state" id="loadingState">
            <div class="loading-spinner"></div>
            <p>Loading files...</p>
        </div>

        <div class="main-content" id="mainContent">
            <div class="player-section">
                <div class="now-playing">
                    <div class="track-info">
                        <h2 id="currentTrackName">No Surah selected</h2>
                        <p id="currentArtist">Select Surah and Press PLAY button to start the recitation of the Quran</p>
                        <!--p id="currentDuration">--:-- / --:--</p-->
                    </div>
                </div>

                <div class="progress-container">
                    <div class="progress-bar" id="progressBar">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div class="time-display">
                        <span id="currentTime">0:00</span>
                        <span id="totalTime">0:00</span>
                    </div>
                </div>

                <div class="controls">
                    <button class="control-btn" id="prevBtn" title="Previous">
                        <i class="fas fa-step-backward"></i>
                    </button>
                    <button class="control-btn play-btn" id="playBtn" title="Play">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="control-btn" id="nextBtn" title="Next">
                        <i class="fas fa-step-forward"></i>
                    </button>
                </div>

                <div class="volume-container">
                    <i class="fas fa-volume-down"></i>
                    <input type="range" id="volumeSlider" class="volume-slider" min="0" max="100" value="70">
                    <i class="fas fa-volume-up"></i>
                </div>
            </div>

            <div class="playlist-section">
                <h3 class="playlist-header">Playlist</h3>
                <ul class="track-list" id="trackList"></ul>
                <div class="empty-state" id="emptyPlaylist" style="display: none;">
                    <i class="fas fa-music"></i>
                    <h3>No files available</h3>
                    <p>Add your files to the Quran folder</p>
                </div>
            </div>
        </div>
    </div>

    <audio id="audioPlayer" preload="metadata"></audio>

    <script>
        class AudioPlayer {
            constructor() {
                // Audio elements
                this.audio = document.getElementById('audioPlayer');
                this.currentTrackIndex = 0;
                this.tracks = [];
                this.isPlaying = false;
                
                // DOM elements
                this.playBtn = document.getElementById('playBtn');
                this.prevBtn = document.getElementById('prevBtn');
                this.nextBtn = document.getElementById('nextBtn');
                this.progressBar = document.getElementById('progressBar');
                this.progressFill = document.getElementById('progressFill');
                this.volumeSlider = document.getElementById('volumeSlider');
                this.trackList = document.getElementById('trackList');
                this.fileInput = document.getElementById('SurahFiles');
                this.currentTrackName = document.getElementById('currentTrackName');
                this.currentArtist = document.getElementById('currentArtist');
                this.currentTime = document.getElementById('currentTime');
                this.totalTime = document.getElementById('totalTime');
                this.mainContent = document.getElementById('mainContent');
                this.loadingState = document.getElementById('loadingState');
                this.errorMessage = document.getElementById('errorMessage');
                this.emptyPlaylist = document.getElementById('emptyPlaylist');

                this.bindEvents();
                this.initializeVolume();
                this.tryLoadMusicFolder();
            }

            bindEvents() {
                // Player controls
                this.playBtn.addEventListener('click', () => this.togglePlay());
                this.prevBtn.addEventListener('click', () => this.playPrevious());
                this.nextBtn.addEventListener('click', () => this.playNext());
                
                // Progress bar
                this.progressBar.addEventListener('click', (e) => this.seek(e));
                
                // Volume control
                this.volumeSlider.addEventListener('input', (e) => this.setVolume(e.target.value));
                
                // Audio events
                this.audio.addEventListener('loadedmetadata', () => this.updateTrackInfo());
                this.audio.addEventListener('timeupdate', () => this.updateProgress());
                this.audio.addEventListener('ended', () => this.playNext());
                this.audio.addEventListener('error', (e) => this.handleAudioError(e));
                this.audio.addEventListener('loadstart', () => this.showLoading(true));
                this.audio.addEventListener('canplay', () => this.showLoading(false));

                // Keyboard shortcuts
                document.addEventListener('keydown', (e) => this.handleKeyboard(e));
            }

            async tryLoadMusicFolder() {
                // Always try to auto-load from Music folder
                await this.loadMusicFromFolder();
            }

            async loadMusicFromFolder() {
                this.showLoading(true);
                this.hideError();
                
                // Predefined list of music files - this works universally
                const SurahFiles = [
                    '001 - سورة الفاتحة.mp3',
					'002 - سورة البقرة.mp3',
					'003 - سورة آل عمران.mp3',
					'004 - سورة النساء.mp3',
					'005 -  سورة المائدة.mp3',
					'006 - سورة الأنعام.mp3',
					'007 - سورة الأعراف.mp3',
					'008 - سورة الأنفال.mp3',
					'009 - سورة التوبة.mp3',
					'010 - سورة يونس.mp3',
					'011 - سورة هود.mp3',
					'012 - سورة يوسف.mp3',
					'013 - سورة الرعد.mp3',
					'014 -  سورة إبراهيم.mp3',
					'015  - سورة الحجر.mp3',
					'016 - سورة النحل.mp3',
					'017 - سورة الإسراء.mp3',
					'018 - سورة الكهف.mp3',
					'019 - سورة مريم.mp3',
					'020 - سورة طه.mp3',
					'021 - سورة الأنبياء.mp3',
					'022 - سورة الحج.mp3',
					'023 - سورة المؤمنون.mp3',
					'024 - سورة النور.mp3',
					'025 - سورة الفرقان.mp3',
					'026 - سورة الشعراء.mp3',
					'027 - سورة النمل.mp3',
					'028 - سورة القصص.mp3',
					'029 - سورة العنكبوت.mp3',
					'030 - سورة الروم.mp3',
					'031 - سورة لقمان.mp3',
					'032 - سورة السجدة.mp3',
					'033 - سورة الأحزاب.mp3',
					'034 - سورة سبأ.mp3',
					'035 - سورة فاطر.mp3',
					'036 - سورة يس.mp3',
					'037 - سورة الصافات.mp3',
					'038 - سورة ص.mp3',
					'039 -  سورة الزمر.mp3',
					'040 - سورة غافر.mp3',
					'041 - سورة فصلت.mp3',
					'042 - سورة الشورى.mp3',
					'043 - سورة الزخرف.mp3',
					'044 - سورة الدخان.mp3',
					'045 - سورة الجاثية.mp3',
					'046 - سورة الأحقاف.mp3',
					'047 - سورة محمد.mp3',
					'048 - سورة الفتح.mp3',
					'049 - سورة الحجرات.mp3',
					'050 - سورة ق.mp3',
					'051 - سورة الذاريات.mp3',
					'052 - سورة الطور.mp3',
					'053 - سورة النجم.mp3',
					'054 - سورة القمر.mp3',
					'055 - سورة الرحمن.mp3',
					'056 - سورة الواقعة.mp3',
					'057 - سورة الحديد.mp3',
					'058 - سورة المجادلة.mp3',
					'059 - سورة الحشر.mp3',
					'060 - سورة الممتحنة.mp3',
					'061 - سورة الصف.mp3',
					'062 - سورة الجمعة.mp3',
					'063 - سورة المنافقون.mp3',
					'064 - سورة التغابن.mp3',
					'065 - سورة الطلاق.mp3',
					'066 - سورة التحريم.mp3',
					'067 - سورة الملك.mp3',
					'068 - سورة القلم.mp3',
					'069 - سورة الحاقة.mp3',
					'070 - سورة المعارج.mp3',
					'071 - سورة نوح.mp3',
					'072 - سورة الجن.mp3',
					'073 - سورة المزمل.mp3',
					'074 - سورة المدثر.mp3',
					'075 - سورة القيامة.mp3',
					'076 - سورة الإنسان.mp3',
					'077 - سورة المرسلات.mp3',
					'078 - سورة النبأ.mp3',
					'079 - سورة النازعات.mp3',
					'080 - سورة عبس.mp3',
					'081 - سورة التكوير.mp3',
					'082 - سورة الانفطار.mp3',
					'083 - سورة المطففين.mp3',
					'084 - سورة الانشقاق.mp3',
					'085 - سورة البروج.mp3',
					'086 - سورة الطارق.mp3',
					'087 - سورة الأعلى.mp3',
					'088 - سورة الغاشية.mp3',
					'089 -  سورة الفجر.mp3',
					'090 - سورة البلد.mp3',
					'091 - سورة الشمس.mp3',
					'092 - سورة الليل.mp3',
					'093 - سورة الضحى.mp3',
					'094 - سورة الشرح.mp3',
					'095 -  سورة التين.mp3',
					'096 - سورة العلق.mp3',
					'097 - سورة القدر.mp3',
					'098 - سورة البينة.mp3',
					'099 - سورة الزلزلة.mp3',
					'100 - سورة العاديات.mp3',
					'101 - سورة القارعة.mp3',
					'102 - سورة التكاثر.mp3',
					'103 - سورة العصر.mp3',
					'104 - سورة الهمزة.mp3',
					'105 - سورة الفيل.mp3',
					'106 - سورة قريش.mp3',
					'107 - سورة الماعون.mp3',
					'108 - سورة الكوثر.mp3',
					'109 - سورة الكافرون.mp3',
					'110 - سورة النصر.mp3',
					'111 - سورة المسد.mp3',
					'112 - سورة الإخلاص.mp3',
					'113 - سورة الفلق.mp3',
					'114 - سورة الناس.mp3'
	
					
                ];

                try {
                    this.tracks = [];
                    
                    // Create track objects from predefined filenames
                    SurahFiles.forEach((filename, index) => {
                        const track = {
                            name: this.getTrackName(filename),
                            //artist: 'Unknown ',
                            //duration: 0, // Will be updated when played
                            url: `./Quran/${encodeURIComponent(filename)}`,
                            filename: filename,
                            index: index
                        };
                        this.tracks.push(track);
                    });
                    
                    this.tracks.sort((a, b) => a.name.localeCompare(b.name));
                    this.renderPlaylist();
                    this.showMainContent();
                    
                } catch (error) {
                    this.showError('Error loading files: ' + error.message);
                } finally {
                    this.showLoading(false);
                }
            }





            getTrackName(filename) {
                // Remove file extension and clean up the name
                return filename.replace(/\.[^/.]+$/, "").replace(/[-_]/g, ' ');
            }

            renderPlaylist() {
                this.trackList.innerHTML = '';
                
                if (this.tracks.length === 0) {
                    this.emptyPlaylist.style.display = 'block';
                    return;
                }

                this.emptyPlaylist.style.display = 'none';
                
                this.tracks.forEach((track, index) => {
                    const li = document.createElement('li');
                    li.className = 'track-item';
                    li.innerHTML = `
                        <div class="track-number">${index + 1}</div>
                        <div class="track-details">
                            <div class="track-name">${track.name}</div>
                            <div class="track-duration">${this.formatTime(track.duration)}</div>
                        </div>
                    `;
                    
                    li.addEventListener('click', () => this.loadTrack(index));
                    this.trackList.appendChild(li);
                });
            }

            loadTrack(index) {
                if (index < 0 || index >= this.tracks.length) return;
                
                this.currentTrackIndex = index;
                const track = this.tracks[index];
                
                this.audio.src = track.url;
                this.updateActiveTrack();
                this.updateTrackDisplay();
            }

            updateActiveTrack() {
                const trackItems = this.trackList.querySelectorAll('.track-item');
                trackItems.forEach((item, index) => {
                    item.classList.toggle('active', index === this.currentTrackIndex);
                });
            }

            updateTrackDisplay() {
                const track = this.tracks[this.currentTrackIndex];
                if (track) {
                    this.currentTrackName.textContent = track.name;
                    this.currentArtist.textContent = track.artist;
                }
            }

            updateTrackInfo() {
                if (this.audio.duration && !isNaN(this.audio.duration)) {
                    this.totalTime.textContent = this.formatTime(this.audio.duration);
                }
            }

            togglePlay() {
                if (!this.tracks.length) {
                    this.showError('Please load some files first.');
                    return;
                }

                if (this.isPlaying) {
                    this.pause();
                } else {
                    this.play();
                }
            }

            play() {
                this.audio.play().then(() => {
                    this.isPlaying = true;
                    this.playBtn.innerHTML = '<i class="fas fa-pause"></i>';
                }).catch(error => {
                    this.showError('Error playing audio: ' + error.message);
                });
            }

            pause() {
                this.audio.pause();
                this.isPlaying = false;
                this.playBtn.innerHTML = '<i class="fas fa-play"></i>';
            }

            playNext() {
                if (this.currentTrackIndex < this.tracks.length - 1) {
                    this.loadTrack(this.currentTrackIndex + 1);
                } else {
                    this.loadTrack(0); // Loop to first track
                }
                
                if (this.isPlaying) {
                    setTimeout(() => this.play(), 100);
                }
            }

            playPrevious() {
                if (this.currentTrackIndex > 0) {
                    this.loadTrack(this.currentTrackIndex - 1);
                } else {
                    this.loadTrack(this.tracks.length - 1); // Loop to last track
                }
                
                if (this.isPlaying) {
                    setTimeout(() => this.play(), 100);
                }
            }

            seek(e) {
                if (!this.audio.duration) return;
                
                const rect = this.progressBar.getBoundingClientRect();
                const percent = (e.clientX - rect.left) / rect.width;
                const seekTime = percent * this.audio.duration;
                
                this.audio.currentTime = seekTime;
            }

            setVolume(value) {
                this.audio.volume = value / 100;
            }

            updateProgress() {
                if (!this.audio.duration) return;
                
                const percent = (this.audio.currentTime / this.audio.duration) * 100;
                this.progressFill.style.width = percent + '%';
                
                this.currentTime.textContent = this.formatTime(this.audio.currentTime);
            }

            formatTime(seconds) {
                if (isNaN(seconds) || seconds === 0) return '0:00';
                
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs.toString().padStart(2, '0')}`;
            }

            handleKeyboard(e) {
                if (e.target.tagName === 'INPUT') return;
                
                switch(e.code) {
                    case 'Space':
                        e.preventDefault();
                        this.togglePlay();
                        break;
                    case 'ArrowRight':
                        e.preventDefault();
                        this.playNext();
                        break;
                    case 'ArrowLeft':
                        e.preventDefault();
                        this.playPrevious();
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        this.volumeSlider.value = Math.min(100, parseInt(this.volumeSlider.value) + 10);
                        this.setVolume(this.volumeSlider.value);
                        break;
                    case 'ArrowDown':
                        e.preventDefault();
                        this.volumeSlider.value = Math.max(0, parseInt(this.volumeSlider.value) - 10);
                        this.setVolume(this.volumeSlider.value);
                        break;
                }
            }

            initializeVolume() {
                this.setVolume(this.volumeSlider.value);
            }

            showMainContent() {
                this.mainContent.style.display = 'grid';
            }

            showLoading(show) {
                this.loadingState.style.display = show ? 'block' : 'none';
            }

            showError(message) {
                this.errorMessage.textContent = message;
                this.errorMessage.style.display = 'block';
                setTimeout(() => this.hideError(), 5000);
            }

            hideError() {
                this.errorMessage.style.display = 'none';
            }

            handleAudioError(e) {
                console.error('Audio error:', e);
                this.showError('Error loading or playing audio file. The file may be corrupted or in an unsupported format.');
                this.isPlaying = false;
                this.playBtn.innerHTML = '<i class="fas fa-play"></i>';
            }
        }

        // Initialize the player when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            new AudioPlayer();
        });

        // Cleanup URLs when page is unloaded to prevent memory leaks
        window.addEventListener('beforeunload', () => {
            const audioElements = document.querySelectorAll('audio');
            audioElements.forEach(audio => {
                if (audio.src && audio.src.startsWith('blob:')) {
                    URL.revokeObjectURL(audio.src);
                }
            });
        });
    </script>
</body>
</html>
